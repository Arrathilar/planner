{% extends 'base.html' %}
{% load staticfiles %}
{% load mptt_tags %}
{% load widget_tweaks %}
{% load ita_template_tags %}
{% load fontawesome_5 %}

{% block context %}
<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.8.0/Chart.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.8.0/Chart.min.js" type="text/javascript"></script>
    <div class="page-container page-container-bg-solid" xmlns="http://www.w3.org/1999/html"
        xmlns="http://www.w3.org/1999/html">
        <!-- BEGIN CONTENT -->
        <div class="container-fluid container-lf-space">
            <!-- BEGIN PAGE BASE CONTENT -->
            <div id="row1" class="mt-3">
                <div class="row widget-row">
                    {% block 'row1' %}
                    {% endblock %}
                </div>
                <div class="row widget-row">

                    <div class="col">
                        <div class="widget-progress">
                            <div class="widget-progress-element widget-bg-color-blue margin-bottom-25">
                                <span class="widget-progress-title">Виконано проектів
                                    <span class="pull-right">{{ hd_tasks_count }}/{{ active_tasks_count }}</span>
                                </span>
                                <div class="progress">
                                    <div class="progress-bar bg-light" role="progressbar"
                                        style="width: {{ tasks_div }}%;"> </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col">
                        <div class="widget-progress">
                            <div class="widget-progress-element widget-bg-color-red margin-bottom-25">
                                <span class="widget-progress-title">Протерміновано проектів
                                    <span class="pull-right">{{ overdue_tasks_count }}/{{ active_tasks_count }}</span>
                                </span>
                                <div class="progress">
                                    <div class="progress-bar bg-light" role="progressbar"
                                        style="width: {{ overdue_tasks_div }}%;">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col">
                        <div class="widget-progress">
                            <div class="widget-progress-element widget-bg-color-green  margin-bottom-25">
                                <span class="widget-progress-title">Продуктивність
                                    <span class="pull-right">{{ owner_productivity }}%</span>
                                </span>
                                <div class="progress">
                                    <div class="progress-bar bg-light" role="progressbar"
                                        style="width: {{ owner_productivity }}%;">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col">
                        <div class="widget-progress">
                            <div class="widget-progress-element widget-bg-color-purple">
                                <span class="widget-progress-title">Протерміновано завдань
                                    <span
                                        class="pull-right">{{ overdue_inttasks_count }}/{{ active_inttasks_count }}</span>
                                </span>
                                <div class="progress">
                                    <div class="progress-bar bg-light" role="progressbar"
                                        style="width: {{ overdue_inttasks_div }}%;">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    {% comment %} <div class="row widget-row">
        <div class="col-md-3">
            <!-- BEGIN WIDGET THUMB -->
            <div class="widget-thumb widget-bg-color-white text-uppercase margin-bottom-20 ">
                <h4 class="widget-thumb-heading">Бонуси за ведення проектів</h4>
                <div class="widget-thumb-wrap">
                    <i class="widget-thumb-icon bg-purple icon-screen-desktop"></i>
                    <div class="widget-thumb-body">
                        <span class="widget-thumb-body-stat" data-counter="counterup"
                            data-value="{{ owner_bonuses_cm }}">0</span>
                    </div>
                </div>
            </div>
            <!-- END WIDGET THUMB -->
        </div>
        <div class="col-md-3">
            <!-- BEGIN WIDGET THUMB -->
            <div class="widget-thumb widget-bg-color-white text-uppercase margin-bottom-20 ">
                <h4 class="widget-thumb-heading">Бонуси за виконання проектів</h4>
                <div class="widget-thumb-wrap">
                    <i class="widget-thumb-icon bg-red icon-layers"></i>
                    <div class="widget-thumb-body">
                        <span class="widget-thumb-body-stat" data-counter="counterup"
                            data-value="{{ exec_bonuses_cm }}">0</span>
                    </div>
                </div>
            </div>
            <!-- END WIDGET THUMB -->
        </div>
        <div class="col-md-3">
            <!-- BEGIN WIDGET THUMB -->
            <div class="widget-thumb widget-bg-color-white text-uppercase margin-bottom-20 ">
                <h4 class="widget-thumb-heading">Бонуси за виконання завдань</h4>
                <div class="widget-thumb-wrap">
                    <i class="widget-thumb-icon bg-green icon-bulb"></i>
                    <div class="widget-thumb-body">
                        <span class="widget-thumb-body-stat" data-counter="counterup"
                            data-value="{{ inttask_bonuses_cm }}">0</span>
                    </div>
                </div>
            </div>
            <!-- END WIDGET THUMB -->
        </div>
        <div class="col-md-3">
            <!-- BEGIN WIDGET THUMB -->
            <div class="widget-thumb widget-bg-color-white text-uppercase margin-bottom-20 ">
                <h4 class="widget-thumb-heading">Бонуси сумарно</h4>
                <div class="widget-thumb-wrap">
                    <i class="widget-thumb-icon bg-blue icon-bar-chart"></i>
                    <div class="widget-thumb-body">
                        <a href={% url 'bonus_calc' employee_id cm.1 cm.0 %}><span class="widget-thumb-body-stat"
                                data-counter="counterup" data-value="{{ total_bonuses_cm }}">0</span></a>
                    </div>
                </div>
            </div>
            <!-- END WIDGET THUMB -->
        </div>
    </div> {% endcomment %}
    <div class="row widget-row">
        <div class="col-md-4">
            <!-- BEGIN PORTLET-->
            <div class="portlet light tasks-widget">
                <div class="portlet-title">
                    <div class="caption caption-md font-blue">
                        <i class="icon-share font-blue"></i>
                        <span class="caption-subject theme-font bold uppercase">Новини та повідомлення</span>
                    </div>
                </div>
                <div class="portlet-body">
                    <div class="scroller" style="height: 350px;" data-always-visible="1" data-rail-visible1="0"
                        data-handle-color="#D7DCE2">
                        {% for new in news %}
                        <div class="widget-media">
                            <div class="widget-media-elements text-center">
                                <img class="widget-media-avatar circle margin-bottom-15"
                                    src="{{ new.creator.employee.avatar.thumbnail.url }}" alt="">
                            </div>
                            <div class="widget-media-body">
                                <h4 class="widget-media-body-title">
                                    <a href="{% url 'news_detail' new.pk %}">{{ new.title }}</a>
                                </h4>
                                <p class="widget-media-body-subtitle">{{ new.text|slice:":400" }}</p>
                            </div>
                        </div>
                        {% endfor %}
                    </div>
                    <div class="scroller-footer">
                        <div class="btn-arrow-link pull-right">
                            <a href="{% url 'news_list' %}">Дивитись всі новини</a>
                            <i class="icon-arrow-right"></i>
                        </div>
                    </div>
                </div>
            </div>
            <!-- END PORTLET-->
        </div>

        <div class="col-md-4">
            <div class="portlet light">
                <div class="portlet-title">
                    <div class="caption caption-md font-blue">
                        <i class="icon-bell font-blue"></i>
                        <span class="caption-subject theme-font bold uppercase">Найближчі події та свята</span>
                    </div>
                </div>
                <div class="portlet-body">
                    <div class="scroller" style="height: 350px;" data-always-visible="1" data-rail-visible="0">
                        <ul class="feeds">
                            {% for event in events %}
                            <li>
                                <div class="col1">
                                    <div class="cont">
                                        <div class="cont-col1">
                                            <div class="label label-sm label-success">
                                                <i class="fa fa-user"></i>
                                            </div>
                                        </div>
                                        <div class="cont-col2">
                                            <div class="desc">
                                                <a href="{% url 'event_detail' event.pk %}">{{ event.title }}</a>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col2">
                                    {% if event.is_today %}
                                    <div class="label label-sm label-warning"> {{ event.next_date }} </div>
                                    {% else %}
                                    <div class="label label-sm label-success"> {{ event.next_date }} </div>
                                    {% endif %}
                                </div>
                            </li>
                            {% endfor %}
                        </ul>
                    </div>
                    <div class="scroller-footer">
                        <div class="btn-arrow-link pull-right">
                            <a href="{% url 'event_list' %}">Дивитись всі події</a>
                            <i class="icon-arrow-right"></i>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-md-4">
            <div class="portlet light">
                <div class="portlet-title">
                    <div class="caption caption-md font-blue">
                        <i class="icon-clock font-blue"></i>
                        <span class="caption-subject theme-font bold uppercase">Недавні дії</span>
                    </div>
                </div>
                <div class="portlet-body">
                    <div class="scroller" style="height: 380px;" data-always-visible="1" data-rail-visible="0">
                        <ul class="feeds">
                            {% for activity in activities %}
                            <li>({{ activity.timestamp }}) - {{ activity.action }} [{{ activity.extra.title }}]</li>
                            {% endfor %}
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- END PAGE BASE CONTENT -->
    </div>
    <!-- END CONTENT -->
    </div>
    <!-- END CONTAINER -->

{% endblock %}